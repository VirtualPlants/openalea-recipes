commit 463c3bd09bfe8e924e19acad7a2a6af16953a704
Author: Remi Collet <fedora@famillecollet.com>
Date:   Mon Aug 4 10:31:25 2014 +0200

    CVE-2014-2497, NULL pointer dereference, fix #126

--- src/gdxpm.c
+++ src/gdxpm.c
@@ -83,6 +83,16 @@
 	if(overflow2(sizeof(int), number)) {
 		goto done;
 	}
+	for(i = 0; i < number; i++) {
+		/*
+		   avoid NULL pointer dereference
+		   TODO better fix need to manage monochrome/monovisual
+		   see m_color or g4_color or g_color
+		*/
+		if (!image.colorTable[i].c_color) {
+			goto done;
+		}
+	}
 
 	colors = (int *)gdMalloc(sizeof(int) * number);
 	if(colors == NULL) {
